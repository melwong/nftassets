<style type="text/css">

		.bulk-main {float: left; width:800px; background: #fff; margin: 20px 0 2px 14px; padding:30px 30px; box-sizing: border-box; border: 1px solid #e5e5e5; }

	.bulk-main h1 {margin: 0 0 20px 0; line-height: normal; padding: 0 0 15px 0; border-bottom: 3px solid #e5e5e5; }

	.bulk-main h2.headingatt { margin:0 0 0 0;font-weight: 500;font-size: 18px;}

	.bulk-main h2.headingatt select#select {width: 50%; margin: 0 0 0 30px; height: 38px; border: 2px solid #dcdcdc; font-size: 16px; padding: 0 10px; }

	.bulk-main h2.headingatt select#select:focus{box-shadow: none !important;}

	.bulk-main form.attribute_form { width: 100%; box-sizing: border-box;margin: 0; padding: 0;}

	.bulk-main form.attribute_form .postbox2 {width: 100%; background: #f7f7f7; box-shadow:0 0 39px 0 rgba(0,0,0,0.04) !important; border-radius: 0 !important; box-sizing: border-box; padding: 30px 30px; border: 1px solid #e9e9e9;margin: 30px 0 0 0; }

	.bulk-main form.attribute_form .postbox2 h3 {background: none !important; margin: 0 0 25px 0 !important; text-align: center !important; font-size: 24px; line-height: normal;padding: 0 !important;}

	.bulk-main form.attribute_form .postbox2 .textarea-wrap {padding: 0 !important;margin: 0 !important;}

	.bulk-main form.attribute_form .postbox2 .textarea-wrap textarea {margin: 0 0 15px 0 !important; width: 100%; resize: none; background: #fff; border-radius: 3px; border: 1px solid #d8d8d8; padding: 10px 10px !important; box-sizing: border-box;font-size: 18px;color: #000 !important;}

	.bulk-main form.attribute_form .postbox2 .textarea-wrap label { color: #000;font-size: 18px;line-height: normal; margin: 0 0 5px 0; float: left;width: 100%;}

	.bulk-main form.attribute_form .postbox2 .textarea-wrap p {margin: 0 0 20px 0 !important;width: 100% !important; box-sizing: border-box !important; background: #fff !important; border: 1px solid #d8d8d8 !important; border-radius: 3px !important; padding: 10px 10px !important; font-size: 18px; }

	.bulk-main form.attribute_form .postbox2 .textarea-wrap select {width: 100% !important; margin: 0 0 20px 0 !important; background: #fff !important; border: 1px solid #d8d8d8 !important; border-radius: 3px !important; padding: 8px 10px !important; font-size: 16px; line-height: normal !important; color: #000 !important; height: 125px;}

	.bulk-main form.attribute_form .postbox2 .textarea-wrap textarea:focus, .bulk-main form.box .postbox2 .textarea-wrap select:focus{box-shadow: none !important;}

	.bulk-main form.attribute_form .postbox2 p.submit-container { margin: 0 !important;text-align: left !important;}

	.bulk-main form.attribute_form .postbox2 p.submit-container input[type="submit"] {padding: 12px 30px !important;
    background: #ff8a8a !important; border: none !important; box-shadow: none !important; font-size:21px; font-weight: normal !important; cursor: pointer;text-shadow: none !important;text-transform: uppercase;}

	.bulk-main form.attribute_form .postbox2 p.submit-container input[type="submit"]:focus{box-shadow: none !important;outline: none !important;}

	.bulk-main .added { float: left; width: 100%; margin: 25px 0 0 0; font-size: 17px; font-weight: bold;color: #000;}

	.bulk-main h2.nav-tab-wrapper.head_tab { margin: 0 0 30px 0; padding: 0;}

	.bulk-main h2.nav-tab-wrapper.head_tab a.nav-tab {background: #ebebeb; border-radius: 6px; border-bottom-left-radius: 0; border-bottom-right-radius: 0; border: 2px solid #d8d5d5 !important; border-bottom: none !important; font-size: 20px; color: #000; font-weight: 400; margin-right: -5px; padding: 8px 28px; text-transform: capitalize; }

	.bulk-main .loop_text { margin: 36px 0 0 0; padding: 20px 20px; box-sizing: border-box;border: 1px solid #cccccc70; box-shadow: 0 0 11px rgba(212, 212, 212, 0.44);}

	.bulk-main .loop_text .added_loop_text { margin: 0 0 20px 0;}

	.bulk-main .loop_text .added_loop_text p {margin: 0; line-height: normal; font-size: 16px; }

	.bulk-main .loop_text .added_loop_text:last-child { margin: 0;}

	.bulk-main .attr_container {width: 100% !important; margin: 0 0 30px 0 !important; background: #f7f7f7; box-shadow: 0 0 24px 0 rgba(0, 0, 0, 0.07); border: 1px solid #e3e3e3; padding: 0;
    }

	.bulk-main .attr_container form.attr_form { padding: 15px !important;box-sizing: border-box;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_length label {float: left; width: auto; font-size: 17px; text-transform: capitalize; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_length label select {border: 1px solid #000; height: auto; box-shadow: none !important; font-size: 18px; line-height: normal; padding: 4px 6px; margin: 0 12px; }
	
	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_filter label {font-size: 17px;
    font-weight: 500; float: right; width: auto;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_filter label input[type="search"] {width: 297px; margin: 0 0 0 10px; height: 38px; border:2px solid #000000; font-size: 16px; padding: 0 10px; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_filter label input[type="search"]:focus{outline: none !important; box-shadow: none !important;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable {margin: 20px 0 0 0; float: left; width: 100%; background: #fff; border: 1px solid #cccccc69; box-shadow: 0 0 20px rgba(0, 0, 0, 0.08); border-bottom: none;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable thead tr th {    text-align: left; width: 50px !important; padding: 15px 20px; font-size: 18px; font-weight: normal; color: #000;    border-bottom: 2px solid #000;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable thead tr th label {font-size: 18px; font-weight: normal; line-height: normal; color: #000; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable thead tr th input[type="checkbox"] {border: 2px solid #000; height: 20px; width: 20px; margin: 0 10px 0 0;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable thead tr th input[type="checkbox"]:focus{box-shadow: none !important; outline: none !important;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable thead tr th.sorting_asc {background-position: 27% 63%; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr {background: #fff !important; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr td.sorting_1 {  background: #fff !important;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr td {
    text-align: left !important; padding: 15px 20px !important;    border-top: 1px solid #b7b2b2 !important; }

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable.display tbody tr:first-child td{border-top: none !important;}

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr:last-child td {
    border-bottom: 1px solid #b7b2b2;}

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr td input[type="checkbox"] {border: 2px solid #000; height: 20px; width: 20px; margin: 0 10px 0 0; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr td input[type="checkbox"]:focus{box-shadow: none !important; outline: none !important;}

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper table.dataTable tbody tr td label {
    font-size: 18px; font-weight: normal; line-height: normal; color: #000; }

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_info {width: 45%; background: #fff; padding:41px 20px; font-size: 16px; box-sizing: border-box; color: #000 !important;}

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_paginate {width: 55%; background: #fff; padding: 40px 20px 40px 0; font-size: 16px; box-sizing: border-box; }

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_paginate a {padding: 0 0; margin: 0 10px 0 0; font-weight: 500; text-decoration: underline !important;    color: #000 !important; }

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_paginate > a:last-child {
    margin-right: 0; }

    .bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_paginate span a.paginate_button {margin: 0; padding: 0 10px 0 10px; border: none !important; background: none !important; text-decoration: none !important; border-right: 1px solid #000 !important; color: #000 !important; }

	.bulk-main .attr_container form.attr_form div.dataTables_wrapper div.dataTables_paginate span a.paginate_button:last-child {border-right: none !important;margin: 0 10px 0 0;}

	.bulk-main .attr_container form.attr_form .attr_sel {margin: 10px 0 0 0;
    padding: 20px 15px 20px 15px; background: #fff; box-sizing: border-box; border: 1px solid #cccccc69;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.08)}

	.bulk-main .attr_container form.attr_form .attr_sel select {width: 100%; margin: 0 0 0 0; height: 38px; border: 2px solid #d6d6d6; font-size: 16px; padding: 0 10px; }

	.bulk-main .attr_container form.attr_form .terms-to-product-button {background: #fff; margin: 10px 0 0 0; padding: 10px 15px; border: 1px solid #cccccc69; box-shadow: 0 0 20px rgba(0, 0, 0, 0.08); }

	.bulk-main .attr_container form.attr_form .terms-to-product-button input[type="submit"] {margin: 0; padding: 8px 40px !important; background: #ff8a8a !important; border: none !important; box-shadow: none !important; font-size: 21px; font-weight: normal !important; cursor: pointer; text-shadow: none !important; width: auto !important; box-sizing: border-box !important; line-height: normal !important;text-transform: uppercase !important;outline: none !important; }

	.bulk-main h2.nav-tab-wrapper.head_tab a.nav-tab:focus{box-shadow: none !important;}

	.bulk-main .attr_container form.attr_form .delete_btn {background: #fff; margin: 10px 0 0 0; padding: 10px 15px; border: 1px solid #cccccc69; box-shadow: 0 0 20px rgba(0, 0, 0, 0.08); }

	.bulk-main .attr_container form.attr_form .delete_btn input[type="submit"] {margin: 0; padding: 8px 40px !important; background:#ff8a8a !important; border: none !important; box-shadow: none !important; font-size: 21px; font-weight: 500 !important; cursor: pointer; text-shadow: none !important; width: auto !important; box-sizing: border-box !important; line-height: normal !important; outline: none !important; text-transform: uppercase !important; }

	.wc-bulk-attributes-manager_page_sub-page-delete h2.headingatt {display: none;}





</style>


<?php
ini_set('display_errors', 0);

$attribute_taxonomies = wc_get_attribute_taxonomies();

function insert_attribute_product($post_id,$wp_insert_term)	{
	global $wpdb;
	$table_prefix = $wpdb->prefix;
	$results = $wpdb->get_results('insert into `'.$table_prefix.'term_relationships`(object_id,term_taxonomy_id) values("'.$post_id.'","'.$wp_insert_term.'")');
}

?>

<div class="bulk-main">
<!---------------Attribute Tabs code--------------------------------------->


<?php

$action = $_REQUEST['page'];

if($action != 'sub-page-delete'){
?>
	
<?php echo "<h1>Bulk Add WC Attributes Terms To Product</h1>"; ?>

<?php } ?>

<?php
if($action == 'sub-page-delete'){
?>
	
<?php echo "<h1>Bulk Delete WC Attributes</h1>"; ?>

<?php } ?>

<!----- html code for tabs------------>

<h2 class="nav-tab-wrapper head_tab">

<?php

	//Edit by dev
	$action = $_REQUEST['page'];
			
	foreach ($attribute_taxonomies as $tax)
	{
		if(isset($_GET['tab']) && $_GET['tab']=="$tax->attribute_name")
		{
				$style="style='background:#fff;'";
		}else{
				$style="";
		}
				
		if( $action == 'sub-page-delete' && !$_GET['tab'] && $tax->attribute_id == 1){
								
				echo '<a style="background:#fff" href="?page=sub-page-delete&tab='.$tax->attribute_name.'" class="nav-tab">'.$tax->attribute_label.'</a>';
								
		}else{
												
			//echo '<a '.$style.' href="?page=sub-page&tab='.$tax->attribute_name.'" class="nav-tab">'.$tax->attribute_label.'</a>';
			echo '<a '.$style.' href="?page='.$action.'&tab='.$tax->attribute_name.'" class="nav-tab">'.$tax->attribute_label.'</a>';
		}	
   }    		
?>

</h2>

<!------------------Code for searchable attributes------------------------------------->
<link rel="stylesheet" type="text/css" href="<?php echo plugins_url(); ?>/WooCommerce-Bulk-Attributes/libs/css/jquery.dataTables.min.css">

<!---------------------------------------------------------->
<!--------------attibute tabs with list of terms ---------->



<?php 

if(($_GET['tab'] != '') || ($action == 'sub-page-delete')){
echo '<div class="attr_container">';
    
    /*----------------function to save attibute on post meta-----------------*/
    function save_wc_custom_attributes1($post_id, $custom_attributes) 
	{
		$i = 0;
		// Loop through the attributes array
		foreach ($custom_attributes as $name => $value) 
		{
			
			$get_olddata = get_post_meta($post_id,'_product_attributes');
			
			// Create product attributes array
			$product_attributes[$name] = array(
				'name' => $name, // set attribute name
				'value' => $value, // set attribute value
				'is_visible' => 1,
				'is_variation' => 0,
				'is_taxonomy' => 1
			);
			$i++;
		}
   
		/*---------------merge array of already insterted attributes and new selected attibutes---------*/	
		 //Edit by dev
		 //$array_merge = array_merge($product_attributes,$get_olddata[0]);
		 $array_merge = array_merge($product_attributes,$get_olddata);
		 //Edit end 
		
		$array_unique = array_unique($array_merge, SORT_REGULAR);
		// Now update the post with its new attributes
		return update_post_meta($post_id, '_product_attributes', $array_unique);
    
	}
 
    /*--------code to save terms on relationship table----------*/
	if(isset($_POST['submit']))
	{
		
		
		
		if(isset($_POST['id']))
		{
		
			foreach($_POST['id'] as $term)
			{
				global $wpdb;
				$table_prefix = $wpdb->prefix;	
				$results = $wpdb->get_results( 'insert into `'.$table_prefix.'term_relationships`(object_id,term_taxonomy_id) values("'.$_POST['prod_list'].'","'.$term.'")');							
			}

			/*---------------call attribute function to save on post meta-------------- */
			$custom_attributes = array('pa_'.$_POST['attr_name'] => '');
			$ret=save_wc_custom_attributes1($_POST['prod_list'], $custom_attributes);
			/*--------------------------------------------------------------------------*/
			// echo "Attribute added successfully";
		}
	}	
	//Edit by dev
	
				
	if($action == 'sub-page-delete'){
		
		if(isset($_POST['id']))
		{
			$delete_data = $_POST['id'];
			
			foreach($delete_data as $delete_id){
				
				$delete_id;
			
				$tt = $wpdb->get_results("SELECT relations.*, taxes.*, terms.*
					FROM wpd7_term_relationships AS relations
					INNER JOIN wpd7_term_taxonomy AS taxes
					ON relations.term_taxonomy_id = taxes.term_taxonomy_id
					INNER JOIN wpd7_terms AS terms
					ON taxes.term_id = terms.term_id
					WHERE taxes.term_taxonomy_id = '".$delete_id."'");
				
				echo '<div style="text-align: center;">'.$tt[0]->description.' '.' Attribute is deleted'.'</div>';
				
				echo "<br/>";
			
				$wpdb->query("DELETE relations.*, taxes.*, terms.*
					FROM wpd7_term_relationships AS relations
					INNER JOIN wpd7_term_taxonomy AS taxes
					ON relations.term_taxonomy_id = taxes.term_taxonomy_id
					INNER JOIN wpd7_terms AS terms
					ON taxes.term_id = terms.term_id
					WHERE taxes.term_taxonomy_id = '".$delete_id."'");
			
			}
			
		}
		//edit end
	}		
	//Edit by dev
    	
    /*------------show list of terms accoding to attrubutes and product list-------------*/
    foreach ($attribute_taxonomies as $tax){
		
		if($action == 'sub-page-delete'){
			
			if(!isset($_GET['tab'])){
				$_GET['tab'] = "attribute1";
			}
		}
		
        if(isset($_GET['tab']) && $_GET['tab']=="$tax->attribute_name" || $action == 'sub-page-delete' &&  $_GET['tab']== $tax->attribute_name ){

		?>
        <form name="attr_name" method="post" id="frm-example"  class="attr_form">
            <input type="hidden" name="attr_name" value="<?php echo $tax->attribute_name; ?>" />
            <input type="hidden" name="attr_label" value="<?php echo $tax->attribute_label; ?>" />
			<?php
            if (taxonomy_exists(wc_attribute_taxonomy_name("$tax->attribute_name"))){
                $taxonomy_terms1= get_terms( wc_attribute_taxonomy_name("$tax->attribute_name"), 'orderby=name&hide_empty=0' );
            }
			?>
			<table id="example" class="display" cellspacing="0" width="100%">
				<thead>
				  <tr>
					  <th><input name="select_all" value="1" id="example-select-all" type="checkbox" /><label>Select All</label></th>
					 <th>Attributes</th>
				  </tr>
				</thead>
				<tbody>
					<?php
					/*----show list of terms-------------*/
					foreach($taxonomy_terms1 as $term){
					?>
					<tr>       
						 <td><input type="checkbox" name="term[]" value="<?php echo $term->term_id; ?>" /></td>
						<td><label><?php echo $term->name."<br>"; ?></label></td>
					</tr>
					<?php	} ?>
				</tbody>
			</table>

			
			<?php
				$args = array(
				'posts_per_page'   =>-1,
				'orderby'          => 'date',
				'order'            => 'ASC',
				'post_type'        => 'product',
				'post_status'      => 'publish',
				'suppress_filters' => true 
				);
				$posts_array = get_posts( $args );
				/*-------------show list of products---------------*/
			?>
			
					
			<?php if($action == 'sub-page-delete'){ ?>
				<div class="delete_btn">
				<input type="submit" class="attr_btn" name="submit" value="Delete" />
				</div>
			<?php }else{ ?>
		
            
            <div class='attr_sel'>
                <select name='prod_list' style="width:100%;">
				<?php
                    foreach($posts_array as $post){
                        echo "<option value='".$post->ID."'>".$post->post_title."</option>";
                    }
				?>
                </select>
            </div>
            <div class="terms-to-product-button">
            <input type="submit" class="attr_btn" name="submit" value="Submit" />
			</div>
			<?php } ?>
		
        </form>
	<?php
        }
    }
   echo '</div>'; 
}
?>


<!---------Code end-------------------------------->



<h2 class="headingatt">

Add Attributes To Product
<?php
	//global $wpdb;					
	$attribute_taxonomies = wc_get_attribute_taxonomies();

	if ( $attribute_taxonomies ) :
?>
	<script type="text/javascript">
	jQuery(document).ready(function()
	{
		jQuery("#select").change(function()
		{
			jQuery(this).find("option:selected").each(function(){
				
				if(jQuery(this).attr("value")=="red")
				{
					jQuery(".attribute_form").not(".red").hide();
					jQuery(".red").show();
				}
				<?php 
					foreach ($attribute_taxonomies as $tax) :
					if (taxonomy_exists(wc_attribute_taxonomy_name($tax->attribute_name))) :
					$taxonomy_terms[$tax->attribute_name] = get_terms( wc_attribute_taxonomy_name($tax->attribute_name), 'orderby=name&hide_empty=0' );
				?>
				else if(jQuery(this).attr("value")=="<?php echo $tax->attribute_id; ?>"){
					jQuery(".attribute_form").not(".<?php echo $tax->attribute_id; ?>").hide();
					jQuery(".<?php echo $tax->attribute_id; ?>").show();
				}
				<?php
					endif;
					endforeach;
				?>
				else
				{
					jQuery(".attribute_form").hide();
				}
			});
		}).change();
	});
	</script>
<?php endif; ?>


	<select id="select">
		<option>Select Attributes</option>
		<?php
		foreach ($attribute_taxonomies as $tax) :
		if (taxonomy_exists(wc_attribute_taxonomy_name($tax->attribute_name))) :
		$taxonomy_terms[$tax->attribute_name] = get_terms( wc_attribute_taxonomy_name($tax->attribute_name), 'orderby=name&hide_empty=0' );
		//echo $tax->attribute_id."=".$tax->attribute_name."<br>";
		?>
		<option value="<?php echo $tax->attribute_id; ?>"><?php echo ucfirst($tax->attribute_name); ?></option>
		<?php
		endif;
		endforeach;
		?>
	</select>
</h2>

<?php
/*----------------function to save attibute on post meta-----------------*/
function save_wc_custom_attributes($post_id, $custom_attributes) {
    $i = 0;
    // Loop through the attributes array
    foreach ($custom_attributes as $name => $value) {
        // Relate post to a custom attribute, add term if it does not exist
        // wp_set_object_terms($post_id, $value, $name, true);
        
             
        $get_olddata = get_post_meta($post_id,'_product_attributes');
          
        // Create product attributes array
        $product_attributes[$name] = array(
            'name' => $name, // set attribute name
            'value' => $value, // set attribute value
            'is_visible' => 1,
            'is_variation' => 0,
            'is_taxonomy' => 1
        );
        $i++;
    }
   
    /*---------------merge array of already insterted attributes and new selected attibutes---------*/
   
 
    
    //Edit by dev
    // $array_merge = array_merge($product_attributes,$get_olddata[0]);
    $array_merge = array_merge($product_attributes,$get_olddata);
    //edit end 
    
    $array_unique = array_unique($array_merge, SORT_REGULAR);
    // Now update the post with its new attributes
    return update_post_meta($post_id, '_product_attributes', $array_unique);
    
}	

$taxonomy_terms = array();
$i=1;
foreach ($attribute_taxonomies as $tax) :

	if(isset($_POST['save_attributes'.$i]))
	{
		$textarea = $_POST['addtributes_products'.$i];
		//$textarea_array	= explode(",",$textarea);
		$pos = strpos($textarea, ',');
		if ($pos === false) {
			   /* echo "The string ',' was not found in the string ''.";*/
			$textarea = str_replace("\n", "/", $textarea);
			$textarea = str_replace("\r", "", $textarea);
		   
			$pos1 = strpos($textarea, '/');
			
			if ($pos1 === false) {
				/* echo "The string '/' was not found in the string ''.";*/
				 
				$pos2 = strpos($textarea, '|');
				 
				if ($pos2 === false) {
					$textarea_array[] = $textarea; 
					/*echo "not found any sepaator";*/
				}else{
					/*echo "The string '|' was found in the string '',";*/
					$textarea_array	= explode("|",$textarea);   
				}
			}else{
				/* echo "The string '/' was found in the string '',";*/
			    $textarea_array	= explode("/",$textarea);  
			}
			
		} else {
			$textarea_array	= explode(",",$textarea);
		   /* echo "The string ',' was found in the string '',";*/
		   // echo " and exists at position $pos.";
		}
		//exit;
    
		$count = count($textarea_array);
		echo '<div class="loop_text">';
		for($j=0;$j<count($textarea_array);$j++) 
		{
			echo '<div class="added_loop_text">';
			$slug 	= 	strtolower($textarea_array[$j]);
			$term 	= 	term_exists($textarea_array[$j], 'pa_'.$tax->attribute_name);

			if ($term !== 0 && $term !== null) {
				echo "<p>".$textarea_array[$j]." Attribute Alredy Added to Product</p>";
				echo insert_attribute_product($_POST['post_id_'.$i],$term["term_id"]);
			} else {
				
				 echo "<p>".$textarea_array[$j]." Attribute is Added Term.</p>";
				 
				 $wp_insert_term = wp_insert_term( $textarea_array[$j], 'pa_'.$tax->attribute_name, 
									$args = array(
									'description' => $textarea_array[$j] ,
									'slug' => $slug,
									'parent' => '') 
									);

							
				$data  = $_POST['post_id_'.$i];
												
				foreach($data as $value){
					
					//echo $value;					
					echo insert_attribute_product($value,$wp_insert_term["term_id"]);					
					//echo insert_attribute_product($value,$wp_insert_term["term_id"]);
				
				}									
				//exit;
				


			}							
							
			if(isset($wp_insert_term))
			{
				echo "<p>".$textarea_array[$j]." Attribute is Added to Product</p>";	
				//$success = "<div class='added'>Total ".$count." Attributes are Added!</div>";
			}
		 
			/*---------------call attribute function to save on post meta-------------- */
			$custom_attributes = array('pa_'.$_POST['attr_name'] => '');
			
			$data  = $_POST['post_id_'.$i];
			
			foreach($data as $value){
				
				$ret=save_wc_custom_attributes($value, $custom_attributes);
			
			}
			
			/*--------------------------------------------------------------------------*/
		   echo '</div>';
		}
     echo '</div>';
	}			
?>

<form class="attribute_form <?php echo $tax->attribute_id; ?>" action="" style="display:none;" method="POST">
	
	<div class="postbox2 "  id="dashboard_right_now">
		<h3 style="text-align:center; background:#EEEEEE;margin: 0px;padding: 5px;"><?php echo ucfirst($tax->attribute_name); ?></h3>
		<div class="textarea-wrap" id="description-wrap" style="padding: 10px;">
			<label>Add Attributes:</label>
			<textarea cols="30" rows="6" class="form-field1" id="content<?php echo $i; ?>" name="addtributes_products<?php echo $i; ?>" ></textarea>
			<p>Add multiple attributes with comma separated,pipe separated(|) and with new line</p>
		</div>
	
		<div class="textarea-wrap" id="description-wrap" style="padding: 10px;">
		
			<?php   
			$args = array(
				'posts_per_page'   => -1,
				'order'            => 'DESC',
				'post_type'        => 'product',
				'post_status'      => 'publish',
				'suppress_filters' => true 
			);
			$posts_array = get_posts( $args ); 
			?>
		<select class="form-field1" id="parent<?php echo $i; ?>" name="post_id_<?php echo $i; ?>[]" multiple>
				<option value="0" class="level-0">Select Products</option>	
				<?php 
					foreach($posts_array as $posts) 
					{
						echo '<option value="'.$posts->ID.'" class="level-0">'.$posts->post_title.'</option>';
					}
				?>
			
			</select>
		
		</div>
	
		<p class="submit-container">
			<input type="hidden" name="attr_name" value="<?php echo $tax->attribute_name; ?>" />
			<input type="submit" value="Add Attributes <?php echo $i; ?>" class="submit-button" id="save_attributes<?php echo $i; ?>" name="save_attributes<?php echo $i; ?>">
		</p>
	</div>

</form>

<?php 
$i++;
endforeach;

?>

</div>
<!-------------------------------------->
<script src="<?php echo plugins_url(); ?>/WooCommerce-Bulk-Attributes/libs/js/jquery.min.js"></script>
<script src="<?php echo plugins_url(); ?>/WooCommerce-Bulk-Attributes/libs/js/jquery.dataTables.min.js"></script>
<script>
$(document).ready(function (){
	var table = $('#example').DataTable({
		'columnDefs': [{
		'targets': 0,
		'searchable': false,
		'orderable': false,
		'className': 'dt-body-center',
		'render': function (data, type, full, meta){
			//console.log(data);
			return '<input type="checkbox" name="id[]" value="' + $('input[name="term[]"]').val() + '">';
		}
		}],
		'order': [[1, 'asc']]
	});

	// Handle click on "Select all" control
	$('#example-select-all').on('click', function(){
		// Get all rows with search applied
		var rows = table.rows({ 'search': 'applied' }).nodes();
		// Check/uncheck checkboxes for all rows in the table
		$('input[type="checkbox"]', rows).prop('checked', this.checked);
	});

	// Handle click on checkbox to set state of "Select all" control
	$('#example tbody').on('change', 'input[type="checkbox"]', function(){
		// If checkbox is not checked
		if(!this.checked){
			var el = $('#example-select-all').get(0);
			// If "Select all" control is checked and has 'indeterminate' property
			if(el && el.checked && ('indeterminate' in el)){
				// Set visual state of "Select all" control 
				// as 'indeterminate'
				el.indeterminate = true;
			}
		}
	});

	// Handle form submission event
	$('#frm-example').on('submit', function(e){
		var form = this;

		// Iterate over all checkboxes in the table
		table.$('input[type="checkbox"]').each(function(){
			// If checkbox doesn't exist in DOM
			if(!$.contains(document, this)){
				// If checkbox is checked
				if(this.checked){
					// Create a hidden element 
					$(form).append(
						$('<input>')
						.attr('type', 'hidden')
						.attr('name', this.name)
						.val(this.value)
					);
				}
			} 
		});
	});

});
</script>
<!------------------------------------------->
